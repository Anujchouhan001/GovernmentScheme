{% extends 'base.html' %}

{% block title %}All Schemes{% endblock %}

{% block content %}
<div class="container py-5">
    <div class="text-center mb-5">
        <h1><i class="fas fa-list-alt text-primary me-3"></i>All Government Schemes</h1>
        <p class="lead text-muted">Browse all {{ schemes|length }} schemes in our database</p>
    </div>

    <!-- Search Filter -->
    <div class="card mb-4">
        <div class="card-body">
            <div class="row align-items-center">
                <div class="col-md-8">
                    <input type="text" class="form-control" id="searchInput" placeholder="ðŸ” Search schemes by name...">
                </div>
                <div class="col-md-4 mt-3 mt-md-0">
                    <a href="/find-schemes" class="btn btn-primary w-100">
                        <i class="fas fa-filter me-2"></i>Find Personalized Schemes
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Schemes List -->
    <div class="row" id="schemesList">
        {% for scheme in schemes %}
        <div class="col-md-6 col-lg-4 mb-4 scheme-item">
            <div class="card h-100">
                <div class="card-body">
                    <h6 class="card-title scheme-name">{{ scheme.scheme_name }}</h6>
                    <p class="text-muted small mb-2">
                        <i class="fas fa-map-marker-alt me-1"></i>{{ scheme.state_name }}
                    </p>
                    <p class="card-text small">
                        {{ scheme.details[:120] }}{% if scheme.details|length > 120 %}...{% endif %}
                    </p>
                </div>
                <div class="card-footer bg-transparent">
                    <a href="/scheme/{{ loop.index0 }}" class="btn btn-outline-primary btn-sm">
                        <i class="fas fa-info-circle me-1"></i>View Details
                    </a>
                    <a href="{{ scheme.scheme_url }}" target="_blank" class="btn btn-sm btn-link">
                        <i class="fas fa-external-link-alt"></i>
                    </a>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>

    <!-- No Results Message -->
    <div id="noResults" class="text-center py-5" style="display: none;">
        <i class="fas fa-search fa-3x text-muted mb-3"></i>
        <h4>No schemes match your search</h4>
        <p class="text-muted">Try a different search term</p>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    // Simple search filter
    document.getElementById('searchInput').addEventListener('keyup', function() {
        const searchTerm = this.value.toLowerCase();
        const schemes = document.querySelectorAll('.scheme-item');
        let visibleCount = 0;

        schemes.forEach(function(scheme) {
            const name = scheme.querySelector('.scheme-name').textContent.toLowerCase();
            if (name.includes(searchTerm)) {
                scheme.style.display = 'block';
                visibleCount++;
            } else {
                scheme.style.display = 'none';
            }
        });

        // Show/hide no results message
        document.getElementById('noResults').style.display = visibleCount === 0 ? 'block' : 'none';
    });
</script>
{% endblock %}
